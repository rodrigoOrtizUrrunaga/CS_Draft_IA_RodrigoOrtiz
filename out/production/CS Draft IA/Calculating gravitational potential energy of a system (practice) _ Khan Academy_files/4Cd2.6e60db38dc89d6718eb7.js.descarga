(window.webpackJsonp=window.webpackJsonp||[]).push([["4Cd2"],{U4In:function(e,t,s){"use strict";var n=s("284h"),a=s("TqRt");Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.IssueForm=void 0;var i=a(s("lSNA")),r=n(s("q1tI")),o=s("/MKj"),l=s("mR6N"),u=a(s("wa3X")),d=a(s("Pwnf")),h=s("JimW"),m=s("z8VS"),c=a(s("SGU3")),p=a(s("gE8/")),y=s("Vxy9"),g=a(s("tk8g")),f=a(s("12ks")),b=s("MRvb"),w=n(s("whzC")),T=s("skGw"),k=a(s("nVHT")),x=s("SjSX"),_=a(s("cfQQ")),S=n(s("VwlT")),C=s("sbZd"),I=n(s("HEOz"));class E extends r.Component{constructor(){super(),(0,i.default)(this,"handleSelectIssueType",(e=>{this.setState({issueType:e})})),(0,i.default)(this,"handleSubmit",(e=>{e.preventDefault();const{exerciseName:t,currentItem:s}=this.props;if(this.state.submitting)return;if(null==this.state.issueType)return void this.setState({error:I._("Please specify the issue type.")});const n=this.issueBody?this.issueBody.value:"";if(""===n)return void this.setState({error:I._("Please provide a description of the issue.")});const a=["MathJax is "+("undefined"==typeof MathJax?"NOT loaded":"loaded, "+(MathJax.isReady?"":"NOT ")+"ready, queue length: "+MathJax.Hub.queue.queue.length),"undefined"==typeof sessionStorage||void 0===sessionStorage.getItem?"sessionStorage NOT enabled":null,this.props.errorMessage,Object.keys("undefined"==typeof MathJax?{}:MathJax.Ajax.loading).map((e=>-1===MathJax.Ajax.loading[e].status?[e+": error"]:[])).join("\n")].filter((e=>null!=e)).join("\n\n"),{profile:i}=this.props,r=(0,b.toAbsoluteUrl)("/item/"+s.id),o={debugInfo:a,bodyInfo:null!=s.questionIndex?"[item question ".concat(s.questionIndex+1,"] ").concat(n):n,email:i?i.get("email"):"N/A",kaid:(0,x.getKaid)(i)||"N/A",exercise:t,item:s.id,itemUrl:r,type:this.state.issueType?{"wrong-answer":"Wrong answer",typo:"Typo",confusing:"Question or hints confusing",bug:"Bug",i18n:"Not translated"}[this.state.issueType]:"Other"};this.setState({error:null,message:null,submitting:!0}),f.default.markConversion("exercise_submit_issue"),this.sendIssueReport(o).then((e=>{this.setState({submitting:!1,submitted:!0,message:I._("Thank you for your feedback! An issue has been opened and we'll look into it shortly.")})})).catch((()=>{this.setState({submitting:!1,submitted:!0,message:I._("Thank you for your feedback!")})}))})),(0,i.default)(this,"sendIssueReport",(e=>{const t={fields:{debug_info:e.debugInfo,project:{key:"AI"},issuetype:{name:"Item issue report"},email:e.email,kaid:e.kaid,description:e.bodyInfo,readable_id:[e.exercise],item_data:[e.item],item_url:e.itemUrl,user_agent:navigator.userAgent,issue_type:{value:e.type},locale:[g.default.getLocale()]}};return(0,T.khanFetch)("/content-issue-post",{method:"POST",body:JSON.stringify(t),headers:{"Content-Type":"application/json"}}).then((e=>e.json()))})),(0,i.default)(this,"getPlaceholderText",(()=>{switch(this.state.issueType){case"wrong-answer":return I._("Tell us what the correct answer should be, and how you got to that answer.");case"typo":return I._("Tell us what the incorrect text says and what it should say instead.");case"confusing":return I._("Tell us exactly what you found confusing. How would you reword the question or hints to be less confusing?");case"bug":return I._("Tell us exactly what happened and what you had expected to happen instead.");default:return""}})),this.state={issueType:null,error:null,message:null,submitting:!1,submitted:!1}}renderIssueTypeOptions(){const e=["wrong-answer","typo","confusing","bug"];"en"!==g.default.getLanguage()&&e.push("i18n");const t={"wrong-answer":I._("The answer is wrong."),typo:I._("I caught a typo."),confusing:I._("The question or hints are confusing or unclear."),bug:I._("Something isnâ€™t working / something seems broken."),i18n:I._("The question or hints are in English.")},s=e=>this.props.issueLabels&&this.props.issueLabels[e]?this.props.issueLabels[e]:t[e];return r.createElement(m.RadioGroup,{groupName:"issue-type",onChange:this.handleSelectIssueType,selectedValue:this.state.issueType},e.map((e=>r.createElement(m.Choice,{label:s(e),value:e,disabled:this.state.submitting,key:e}))))}renderCTAs(){return r.createElement(h.View,{style:P.buttonContainer},r.createElement(u.default,{onClick:this.props.showAllHints,disabled:this.state.submitting||!this.props.hintsRemaining,size:"small",style:P.button,key:"showAnswer"},I._("Show answer")),r.createElement(u.default,{onClick:this.handleSubmit,disabled:this.state.submitting,size:"small",kind:"secondary",style:P.button,key:"submitIssue"},I._("Submit Issue")),this.state.submitting?r.createElement(k.default,{key:"spinner"}):r.createElement(u.default,{onClick:this.props.onCancel,size:"small",kind:"tertiary",style:P.button,key:"cancel"},I._("Cancel")))}renderTestPrepCTAs(){return r.createElement(h.View,{style:[P.buttonContainer,P.testPrepButtonContainer]},this.state.submitting?r.createElement(k.default,{key:"spinner"}):r.createElement(u.default,{onClick:this.props.onCancel,size:"small",kind:"tertiary",style:P.testPrepButton,key:"cancel"},I._("Cancel")),r.createElement(u.default,{onClick:this.handleSubmit,disabled:this.state.submitting,size:"small",kind:"primary",style:P.testPrepButton,key:"submitIssue"},I._("Submit Issue")))}render(){const e=w.safeLinkTo("https://khanacademy.zendesk.com/hc/requests/new"),t=r.createElement(c.default,{href:e,target:"_blank",skipClientNav:!0},I._("report any technical problems"));return r.createElement(h.View,null,r.createElement(y.LabelLarge,{tag:"h4"},I._("Report a mistake in this question")),!this.state.submitted&&r.createElement(h.View,null,r.createElement(y.Body,{style:P.explanatoryText},this.props.introText?this.props.introText:I._("Remember to read through the hints and double check your answer. Thanks for your help!")),r.createElement("fieldset",{className:(0,l.css)(P.issueTypeFieldset)},r.createElement(y.LabelMedium,{tag:"legend"},I._("What's wrong?")),this.renderIssueTypeOptions(),r.createElement(y.Body,{style:P.explanatoryText},I.$_("Alternatively, you can %(reportLink)s you may be experiencing.",{reportLink:t}))),r.createElement(h.UniqueIDProvider,{mockOnFirstRender:!1,scope:"issue-form"},(e=>{const t=e.get("issue-body");return r.createElement(r.Fragment,null,r.createElement(y.LabelMedium,{tag:"label",htmlFor:t},I._("Description of issue:")),r.createElement("textarea",{name:"issue-body",id:t,placeholder:this.getPlaceholderText(),ref:e=>this.issueBody=e,rows:4,className:(0,l.css)(y.styles.LabelSmall,P.issueBody)}))})),this.props.testPrepContentIssue?this.renderTestPrepCTAs():this.renderCTAs()),this.state.error&&r.createElement(y.Body,{style:P.explanatoryText},this.state.error),!this.state.error&&this.state.message&&r.createElement(y.Body,{style:P.explanatoryText},this.state.message))}}(0,i.default)(E,"defaultProps",{testPrepContentIssue:!1});const v=(0,_.default)(E);t.IssueForm=v;const P=l.StyleSheet.create({issueTypeFieldset:{marginTop:p.default.medium_16,marginBottom:p.default.medium_16,paddingTop:p.default.xSmall_8,paddingBottom:p.default.xSmall_8},explanatoryText:{marginTop:p.default.xSmall_8},issueBody:{resize:"vertical",marginTop:p.default.xxxSmall_4,minHeight:p.default.large_24,borderColor:d.default.offBlack32},buttonContainer:{flexDirection:"row",marginTop:p.default.medium_16},testPrepButtonContainer:{justifyContent:"flex-end"},button:{marginRight:p.default.small_12},testPrepButton:{marginLeft:p.default.medium_16}});var A=(0,o.connect)((e=>{const{taskProgress:t,problemProgress:s,environmentState:n}=e,{exerciseName:a}=(0,C.getCurrentExerciseData)(e);return{currentItem:{id:t.assessmentItemMetadata.id,sha:t.assessmentItemMetadata.sha},errorMessage:n.errorMessage,exerciseName:a,hintsRemaining:s.hintsVisible<s.totalHints}}),(e=>({showAllHints:()=>e(S.showAllHintsAndSendHintLogs())})))(v);t.default=A}}]);
//# sourceMappingURL=../../sourcemaps/en/4Cd2.6e60db38dc89d6718eb7.js.map