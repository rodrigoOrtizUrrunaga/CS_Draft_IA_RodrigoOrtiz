(window.webpackJsonp=window.webpackJsonp||[]).push([["7KFP"],{"/X8e":function(e,t,s){"use strict";var o=s("284h"),n=s("TqRt");Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.StatefulExerciseManager=void 0;var a=n(s("pVnL")),r=n(s("lSNA")),i=o(s("q1tI")),d=s("mR6N"),l=s("/MKj"),p=s("Pk2J"),c=n(s("Pwnf")),h=n(s("SGU3")),u=s("JimW"),m=o(s("4PhQ")),f=o(s("bHum")),k=n(s("7e7+")),g=s("sbZd"),b=o(s("VwlT")),C=s("vttG"),P=o(s("whzC")),y=n(s("Hy2Q")),w=o(s("6OHE")),S=n(s("KGvg")),x=n(s("wF1t")),T=n(s("cfQQ")),v=n(s("4Du/")),E=s("Y8R6"),A=o(s("HEOz"));const N=C.initialize;class R extends i.Component{constructor(...e){super(...e),(0,r.default)(this,"state",{error:null,itemRenderer:null,isFullyRendered:!1}),(0,r.default)(this,"loadData",((e=!1)=>{const t=!this.props.flagLoading&&this.props.flag;if(!this.props.exercise||this.props.taskData&&!e)this.props.taskData&&this.props.dispatch(b.loadFromTaskData(this.props.taskData,t));else{const{exercise:s}=this.props;this.props.dispatch(b.loadFromExerciseId(s.contentId||s.id,t,e))}})),(0,r.default)(this,"handleRendered",(e=>t=>{this.setState({isFullyRendered:t}),e({id:"started_problem"})})),(0,r.default)(this,"handleGotoNextProblem",(()=>{this.setState({isFullyRendered:!1});const{dispatch:e,onGotoNextProblem:t}=this.props;t&&t();const s=!this.props.flagLoading&&this.props.flag;e(b.gotoNextProblem(s))})),(0,r.default)(this,"handleShowRelatedContents",(()=>{this.props.dispatch(b.showRelatedContents())})),(0,r.default)(this,"handleShowHint",(()=>{this.props.dispatch(b.showHintAndSentHintLog())})),(0,r.default)(this,"handlePracticeAgain",(()=>{this.props.onPracticeAgain&&this.props.onPracticeAgain(),this.loadData(!0)})),(0,r.default)(this,"handleAnswerableChanged",(e=>{this.props.problemProgress.answerable!==e&&this.props.dispatch(b.answerableChanged(e))})),(0,r.default)(this,"handleKeypadLayoutChanged",(e=>{this.props.dispatch(b.keypadLayoutChanged(e))})),(0,r.default)(this,"hideFeedbackPopover",(()=>{this.props.dispatch(b.hideFeedbackPopover())})),(0,r.default)(this,"handleReloadTask",(()=>{"function"==typeof this.props.onReloadTask&&this.props.onReloadTask(),this.props.dispatch(b.reloadExercise())})),(0,r.default)(this,"dismissKeypadIfVisible",(e=>{e&&this.props.problemProgress.keypadHeight&&e.blur()})),(0,r.default)(this,"handleCheckAnswer",(e=>t=>{if(null==t)throw new m.KAError("cannot check answer on null item renderer",m.Errors.Internal);const s=t.scoreInput();this.checkAnswer(s,!1),e({id:"click_check_answer"}),s.empty||t.showRationalesForCurrentlySelectedChoices()})),(0,r.default)(this,"handleHideFeedbackPopover",(e=>{this.hideFeedbackPopover(),e&&"unanswered"!==this.props.problemProgress.answerStatus&&e.deselectIncorrectSelectedChoices()})),(0,r.default)(this,"handleInteraction",(e=>{this.props.problemProgress.feedbackPopoverVisible&&this.handleHideFeedbackPopover(e),this.props.dispatch(b.interacted())})),(0,r.default)(this,"handleSkipQuestion",(e=>{if(null==e)throw new m.KAError("cannot skip question on null item renderer",m.Errors.Internal);this.checkAnswer(e.scoreInput(),!0),this.handleGotoNextProblem()})),(0,r.default)(this,"handleSubmit",(e=>t=>{this.props.problemProgress.problemComplete?this.handleGotoNextProblem():this.handleCheckAnswer(e)(t)})),(0,r.default)(this,"handleDrawingAreaToggle",(e=>{this.props.dispatch(b.setDrawingAreaAvailability(e))})),(0,r.default)(this,"handleNextTask",(()=>{this.props.dispatch(b.gotoNextTask())}))}componentDidMount(){this.props.environmentState.isLoaded||this.loadData()}UNSAFE_componentWillUpdate(e){this.props.exerciseName!==e.exerciseName&&this.props.dispatch(b.resetIsLoaded());const{location:{queryParams:t}}=this.props;t.lp_cheats&&(window.statefulExerciseManager=this)}componentDidUpdate(e){const{isLoaded:t}=this.props.environmentState,s=e.environmentState.isLoaded,{isFullyRendered:o}=this.state;if(!s&&t&&this.props.onRendered&&this.props.onRendered(this.props.taskInfo,this.props.taskProgress),t&&o&&this.props.onComponentUsable&&this.props.onComponentUsable(),s&&!t&&this.loadData(),s){const{taskInfo:t,taskProgress:s,problemProgress:o,exercise:n,exerciseName:a}=this.props,{taskProgress:r,problemProgress:i}=e;if(!i.problemComplete&&o&&o.problemComplete&&this.props.onProblemComplete&&this.props.onProblemComplete(),!r.taskComplete&&s&&s.taskComplete){const e=s.progressByExercise[n?n.slug:a],o=e&&e.currentFpmLevel;this.props.onTaskComplete&&this.props.onTaskComplete(s.attemptHistory,t,n,s.pointsEarned,o)}}}componentDidCatch(e,t){this.setState({error:e.toString()}),m.default.error(e,m.Errors.Internal,{sentry:{extras:t}})}checkAnswer(e,t){const s=this.props.environmentState.inPractice?"practice":null;this.props.dispatch(b.checkAnswerAndMaybeSendProblemLog(e,t,s))}render(){const e=!this.props.environmentState.isLoaded&&this.props.environmentState.error;if(!this.props.environmentState.isLoaded&&!e)return i.createElement("div",{className:(0,d.css)(_.loadingWrapper)},i.createElement(k.default,{sentryId:"exercise_manager_load",sentryTeam:"learning-platform",description:"Loading exercises"}));if(this.state.error||e){const e=P.safeLinkTo("https://www.khanacademy.org/reportissue?type=Defect"),t=i.createElement(h.default,{href:e,skipClientNav:!0,light:!0,style:_.errorLink},A._("tell us")),s=i.createElement(h.default,{onClick:()=>(0,E.reload)(),skipClientNav:!0,light:!0,style:_.errorLink},A._("refresh")),o=A.$_("Uh oh, it looks like we ran into an error. You need to %(refresh)s. If this problem persists, %(tellUs)s.",{refresh:s,tellUs:t});return i.createElement(u.View,{style:_.errorContainer},o,A.$_(" [Error code: %(errorCode)s]",{errorCode:this.state.error||this.props.environmentState.error&&this.props.environmentState.error.code}))}const{domain:t,referrer:s,exercise:o,masteryEnabled:n,ExerciseComponent:r,EndOfTaskCard:l,taskInfo:p,taskProgress:c,problemProgress:m,environmentState:g,inModal:b,profile:C}=this.props,y=i.createElement("a",{href:"/settings#hidevisual"},A._("your account settings")),w=C&&C.get("hideVisual"),x={taskInfo:p,taskProgress:c,problemProgress:m,screenReaderMessage:m.requiresScreenOrMouse&&!w&&i.createElement("div",{className:"sr-only screen-reader-escape"},A.$_('This exercise contains content you may be unable to access without the use of a visual display" or mouse. Once logged in, please navigate to %(accountSettingsLink)s to opt-out of future questions like these.',{accountSettingsLink:y})),onAnswerableChanged:this.handleAnswerableChanged,onDrawingAreaToggle:this.handleDrawingAreaToggle,onGotoNextProblem:this.handleGotoNextProblem,onPracticeAgain:this.handlePracticeAgain,onShowHint:this.handleShowHint,onShowRelatedContents:this.handleShowRelatedContents,onCloseTask:this.props.onCloseTask,onReloadTask:this.handleReloadTask,EndOfTaskCard:l,practiceAgainMessage:this.props.practiceAgainMessage,masteryEnabled:n,inModal:b,onSkipQuestion:this.handleSkipQuestion,onHideFeedbackPopover:this.handleHideFeedbackPopover,onInteraction:this.handleInteraction},T={nextTaskKind:g.nextTaskKind,onNextTask:this.handleNextTask},v={domain:t,referrer:s,error:g.error,dismissKeypadIfVisible:this.dismissKeypadIfVisible,onKeypadLayoutChanged:this.handleKeypadLayoutChanged},N=o?o.contentId||o.id:null,R=o?o.kind||o.contentKind:null,I=o?o.title:null,M=(0,a.default)({},N?{contentId:N}:null,R?{kind:R}:null,I?{contentTitle:I}:null,{assessmentItemId:c.assessmentItemMetadata.id});return i.createElement(f.default,{learningTimeInfo:(0,a.default)({activity:f.enums.Activity.PRACTICING,content:M},p.taskKey?{task:{taskKey:p.taskKey}}:null)},(e=>i.createElement(S.default.Provider,{value:{onRendered:this.handleRendered(e)}},i.createElement(r,(0,a.default)({},x,T,v,{onCheckAnswer:this.handleCheckAnswer(e),onSubmit:this.handleSubmit(e)})))))}}const I=(0,p.compose)(v.default,T.default,(0,x.default)({name:"use_assessment_item_go_query"}),(0,l.connect)((e=>e),void 0,void 0,{withRef:!0}))(R);t.StatefulExerciseManager=I;const _=d.StyleSheet.create({loadingWrapper:{flex:1,display:"flex",alignItems:"center",justifyContent:"center",paddingBottom:60},errorContainer:{display:"block",width:y.default.wrapperWidth,[w.queries.small]:{width:"auto"},height:"fit-content",padding:16,margin:"0 auto",backgroundColor:c.default.red,borderRadius:4,color:c.default.white,textAlign:"center",fontSize:15,zIndex:2},errorLink:{textDecoration:"underline"}});class M extends i.Component{constructor(e){super(e),(0,r.default)(this,"loadData",((e=!1)=>{this.exerciseManager&&this.exerciseManager.getWrappedInstance().loadData(e)}));const{nextItem:t,nextTaskKind:s,topic:o,topicId:n,onCheckAnswer:a,onNextTask:i,onUpdateRecommendations:d,inModal:l,inPractice:p,onShowRelatedContent:c}=e;this.state={store:(0,g.create)({nextItem:t,nextTaskKind:s,topic:o,topicId:n,inModal:l,inPractice:p,onShowRelatedContent:c},(0,C.handleSideEffects)({onCheckAnswer:a,onUpdateRecommendations:d,onNextTask:i}))}}componentDidMount(){N()}render(){const{ExerciseComponent:e,domain:t,exercise:s,masteryEnabled:o,taskData:n,exerciseName:a,inModal:r,onRendered:d,onProblemComplete:p,onTaskComplete:c,onComponentUsable:h,onGotoNextProblem:u,onCloseTask:m,onPracticeAgain:f,onReloadTask:k}=this.props;return i.createElement(l.Provider,{store:this.state.store},i.createElement(I,{ExerciseComponent:e,domain:t,exercise:s,masteryEnabled:o,taskData:n,exerciseName:a,inModal:r,onRendered:d,onProblemComplete:p,onTaskComplete:c,onComponentUsable:h,onGotoNextProblem:u,onCloseTask:m,onPracticeAgain:f,onReloadTask:k,ref:e=>this.exerciseManager=e}))}}t.default=M,(0,r.default)(M,"defaultProps",{inModal:!1,inPractice:!1,masteryEnabled:!1,nextItem:null,nextTaskKind:null,domain:"default"})},HuuM:function(e,t,s){"use strict";var o=s("TqRt");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,a=o(s("VkAN")),r=o(s("mXPZ")),i=o(s("wINb")),d=o(s("lTCR")),l=o(s("o1mU"));const p={endOfTask:{fileName:"end-of-task",volume:.5},questionCorrect:{fileName:"question-correct",volume:.3}},c={"audio/ogg":"ogg","audio/mpeg":"mp3","audio/x-wav":"wav"},h=(0,d.default)(n||(n=(0,a.default)(["\n    query getUserSoundPref {\n        user {\n            id\n            soundOn\n        }\n    }\n"])));var u={initialize:function(){if(!0===this.initialized)return;if(this.initialized=!0,this.soundClips={},this.soundOn=!1,!window.Audio)return;this._fetchSoundSetting();const e=new Audio(""),t=Object.keys(c).find((t=>e.canPlayType&&""!==e.canPlayType(t)));if(t){const e=c[t];Object.keys(p).forEach((t=>{const{volume:s,fileName:o}=p[t],n=new Audio((0,i.default)("/sounds/".concat(o,".").concat(e)));n.volume=s,this.soundClips[t]=n}))}},_fetchSoundSetting:function(){r.default.isLoggedIn?(0,l.default)(h).then((e=>{this.soundOn=e.data.user.soundOn})):this.soundOn=!0},_playSound:function(e){this.initialize();const t=this.soundClips[e];t&&t.readyState&&this.soundOn&&(t.currentTime=0,t.play())},playSoundEndOfTask:function(){this._playSound("endOfTask")},playSoundQuestionCorrect:function(){this._playSound("questionCorrect")}};t.default=u},vttG:function(e,t,s){"use strict";var o=s("TqRt");Object.defineProperty(t,"__esModule",{value:!0}),t.initialize=function(){n.default.initialize()},t.handleSideEffects=void 0;var n=o(s("HuuM")),a=s("pCog"),r=o(s("Jayu"));t.handleSideEffects=e=>(t,s)=>{switch(t.type){case"ON_UPDATE_RECOMMENDATIONS":e.onUpdateRecommendations&&e.onUpdateRecommendations(t.recommendations);break;case"CHECK_ANSWER":s.problemProgress&&s.problemProgress.problemComplete&&n.default.playSoundQuestionCorrect();let o="unstarted";s.taskProgress&&(s.taskProgress.promotionCriteriaSatisfied?o="complete":s.taskProgress.attemptHistory.length>0&&(o="started")),e.onCheckAnswer&&e.onCheckAnswer(o);break;case"GOTO_NEXT_PROBLEM":s.taskProgress&&s.taskProgress.taskComplete&&s.taskProgress.promotionCriteriaSatisfied&&n.default.playSoundEndOfTask();break;case"MOVING_TO_NEXT_TASK":e.onNextTask&&e.onNextTask();break;case"ON_FPM_PROMOTIONS":const{promotions:i}=t;r.default.dispatch((0,a.updateProgress)(i))}}}}]);
//# sourceMappingURL=../../sourcemaps/en/7KFP.606478f34e82888a1249.js.map